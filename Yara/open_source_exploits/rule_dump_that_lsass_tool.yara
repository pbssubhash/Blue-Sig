rule dump_that_lsass_tool {
    meta:
        author = "Subhash P <@pbssubhash>"
        filetype = "Win32 EXE"
        date = "31/12/2022"
        version = "1.0"
        reference = "https://github.com/D1rkMtr/DumpThatLSASS"
        sha256 = "c8c3f5890c336c114b24f333efa1ddea8412a29f97e2576049a5a0e00d1b77c0"

    strings:
        $mz = { 4d 5a }
        $a1 = "C:\\Windows\\System32\\dbghelp.dll" fullword ascii 
        $a2 = "1$a$$ Dl_lmp in" fullword ascii
        $a3 = "MiniDumpWriteDump" fullword ascii
        $a4 = "lsass.exe" fullword wide
        $a5 = "GetTokenInformation" fullword ascii
    condition:
        ($mz at 0) and all of them
}